Kognit USB Writer - macOS Build Instructions
=============================================

To build the macOS installer (.dmg with drag-to-Applications), run the following on your Mac:

1. Clone the repository:
   git clone https://github.com/Patthebunny73/USB_Writer.git
   cd USB_Writer

2. Install prerequisites (if not already installed):
   - Rust: curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
   - Node.js: https://nodejs.org (v18+)
   - Xcode Command Line Tools: xcode-select --install

3. Install dependencies and build:
   cd ui
   npm install
   cd ../src-tauri
   npx tauri build

4. After build completes, the .dmg installer will be at:
   src-tauri/target/release/bundle/dmg/Kognit USB Writer_1.0.0_aarch64.dmg

5. Copy to releases folder:
   cp "src-tauri/target/release/bundle/dmg/Kognit USB Writer_1.0.0_aarch64.dmg" releases/macos/

6. Commit and push:
   git add releases/macos/
   git commit -m "Add macOS installer"
   git push origin main


CODE SIGNING FOR macOS (Required for Distribution)
==================================================

To sign your app so macOS trusts it, you need an Apple Developer account:

1. ENROLL IN APPLE DEVELOPER PROGRAM
   - Go to: https://developer.apple.com/programs/
   - Cost: $99/year (individual) or $299/year (organization)
   - Required for distributing apps outside the Mac App Store

2. CREATE CERTIFICATES (after enrollment)
   - Open Keychain Access on your Mac
   - Go to Apple Developer portal > Certificates, IDs & Profiles
   - Create a "Developer ID Application" certificate
   - Download and install it in Keychain Access

3. SIGN THE APP
   After building, sign the .app bundle:

   codesign --deep --force --verify --verbose \
     --sign "Developer ID Application: Your Name (TEAM_ID)" \
     "src-tauri/target/release/bundle/macos/Kognit USB Writer.app"

4. NOTARIZE THE APP (Required for macOS 10.15+)
   Apple requires notarization for apps distributed outside the App Store:

   # Create a zip for notarization
   ditto -c -k --keepParent \
     "src-tauri/target/release/bundle/macos/Kognit USB Writer.app" \
     "KognitUSBWriter.zip"

   # Submit for notarization
   xcrun notarytool submit KognitUSBWriter.zip \
     --apple-id "your@email.com" \
     --team-id "YOUR_TEAM_ID" \
     --password "app-specific-password" \
     --wait

   # Staple the notarization ticket
   xcrun stapler staple \
     "src-tauri/target/release/bundle/macos/Kognit USB Writer.app"

5. REBUILD THE DMG
   After signing and notarizing, rebuild the .dmg:

   npx tauri build --bundles dmg


ALTERNATIVE: Unsigned Distribution
==================================
If you don't want to pay for Apple Developer Program:

Users can still run unsigned apps by:
1. Right-click the app > Open (first time only)
2. Or: System Settings > Privacy & Security > "Open Anyway"

The app will show "unidentified developer" warning but will work.


TAURI SIGNING CONFIGURATION (Optional)
======================================
Add to src-tauri/tauri.conf.json under "bundle" > "macOS":

"macOS": {
  "minimumSystemVersion": "11.0",
  "signingIdentity": "Developer ID Application: Your Name (TEAM_ID)",
  "notarizationCredentials": {
    "appleId": "your@email.com",
    "teamId": "YOUR_TEAM_ID",
    "password": "@keychain:AC_PASSWORD"
  }
}

Then build normally and Tauri will sign/notarize automatically.
